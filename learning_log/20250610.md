# ì…ì‹¤ ì²´í¬ í•´ì£¼ì„¸ìš” !! ğŸˆ

todo-list í´ë”ë¥¼ vs codeë¡œ ì—´ê³  learning_log í´ë” ìƒì„±
20250610.md íŒŒì¼ ìƒì„±
intellij ì¤€ë¹„

User ì—”í‹°í‹° ì¶”ê°€ ì˜ˆì • -> Todo ì—”í‹°í‹°ì™€ User ì—”í‹°í‹° ì—°ê²° ì˜ˆì •
-> ì˜ˆìƒë˜ëŠ” ë¬¸ì œ

í•´ê²° ë°©ì•ˆ

OAuth2 ë„ì…ì„ ìœ„í•œ êµ¬ê¸€ credentials / secret key ë°œê¸‰ ê³¼ì •

https://console.cloud.google.com ë¡œ ë“¤ì–´ê°€ì„œ êµ¬ê¸€ ë¡œê·¸ì¸
ì¢Œì¸¡ ìƒë‹¨ì— í”„ë¡œì íŠ¸ ê´€ë¦¬ í´ë¦­ -> ìƒˆ í”„ë¡œì íŠ¸
`todo-list-ìƒë…„ì›”ì¼` ë¼ê³  ì´ë¦„ ì§“ê³  ë§Œë“¤ê¸° í´ë¦­

ì½˜ì†” ì¢Œìƒë‹¨ì— `todo-list-ìƒë…„ì›”ì¼` ë¼ê³  ë˜ì–´ìˆëŠ” ê±° í™•ì¸í•˜ë©´
ì¢Œì¸¡ í–„ë²„ê±° í´ë¦­í•´ì„œ `API ë° ì„œë¹„ìŠ¤ -> ì‚¬ìš©ì ì¸ì¦ ì •ë³´`

ìš°ì¸¡ ë§¨ ëì— `ë™ì˜ í™”ë©´ êµ¬ì„±`

todo-listë¡œ ì´ë¦„ ì§“ê³ 
ì—¬ëŸ¬ë¶„ ì´ë©”ì¼

ëŒ€ìƒ - ì™¸ë¶€

OAuth í´ë¼ì´ì–¸íŠ¸ ë§Œë“¤ê¸° í´ë¦­
ì• í”Œë¦¬ì¼€ì´ì…˜ ìœ í˜• - ì›¹ ì• í”Œë¦¬ì¼€ì´ì…˜ ì„ íƒ

ìŠ¹ì¸ëœ ë¦¬ë””ë ‰ì…˜ URI
http://localhost:8080/login/oauth2/code/google

í•˜ê³  í´ë¼ì´ì–¸íŠ¸ ID / ì‹œí¬ë¦¿ í‚¤ ë°œê¸‰

ë°œê¸‰ í›„ì— -> ë°œê¸‰ëœ ì •ë³´ë“¤ì„ ê°€ì§€ê³  ë°±ì—”ë“œ ì‘ì—… -> ê·¸ë¦¬ê³  í”„ë¡ íŠ¸ ì‘ì—…

# ë°±ì—”ë“œ ì‘ì—… íŒŒíŠ¸

ì´ì œ google oauth2ë¥¼ ì‚¬ìš©í• ê²ë‹ˆë‹¤.
ê·¸ëŸ¬ë©´ ì™¸ë¶€ ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— ì–´ë–¤ ê³¼ì •ì´ í•„ìš”í• ê¹Œìš”?

build.gradleì— ì˜ì¡´ì„±ì„ ì¶”ê°€í• ê±°ê¸° ë•Œë¬¸ì— mvn ê²€ìƒ‰í•´ì„œ maven repositoryë¡œ ì ‘ì†

	// Google Oauth2 ê´€ë ¨ ì˜ì¡´ì„±ë“¤
	implementation 'org.springframework.boot:spring-boot-starter-oauth2-client'
	implementation 'org.springframework.boot:spring-boot-starter-oauth2-resource-server'

oauth2-client - ì•±ì´ Google ë¡œê·¸ì¸ í˜ì´ì§€ë¡œ ì´ë™ì‹œí‚¤ëŠ” ë“±ì˜ í´ë¼ì´ì–¸íŠ¸ ì—­í• ì„ í•  ë•Œ í•„ìš”
oauth2-resource-server - ì•± APIê°€ Reactë¡œ ë°›ì€ í† í°ì„ ê²€ì¦í•˜ëŠ” ë¦¬ì†ŒìŠ¤ ì„œë²„ ì—­í• ì„ í•  ë•Œ í•„ìš”(jwt ë“±ì˜ í† í°ì„ ì˜ë¯¸í•©ë‹ˆë‹¤)

ê·¸ë¦¬ê³  ì½”ë¼ë¦¬ ëˆ„ë¥´ëŠ”ê±° í•„ìˆ˜

ë‹¤ìŒì€ application.properties

```properties
spring.security.oauth2.client.registration.google.client-id=
spring.security.oauth2.client.registration.google.client-secret=
# profile, email ì •ë³´ ìš”ì²­
spring.security.oauth2.client.registration.google.scope=profile,email
# jwt í† í° ê²€ì¦ì„ ìœ„í•œ ì„¤ì •(í† í° ë°œê¸‰ì URI)
spring.security.oauth2.resourceserver.jwt.issuer-uri=https://accounts.google.com
```

ë‹¤ìŒ ë°±ì—”ë“œ ê´€ë ¨
User ì—”í‹°í‹° ì„¤ì • ë° Todo ì—”í‹°í‹°ì™€ì˜ ì—°ê²°

```java
package com.example.todo_backend_mariadb.domain;

import jakarta.persistence.*;
import lombok.Builder;
import lombok.Getter;
import lombok.NoArgsConstructor;

@Entity
@Table(name = "users") // userëŠ” DBìƒì—ì„œ ì˜ˆì•½ì–´ë¼ì„œ ì˜¤ë¥˜ê°€ ë°œìƒí•  ê°€ëŠ¥ì„±â†‘ / carì—ì„œëŠ” AppUserì˜€ì£ 
@NoArgsConstructor
@Getter
public class User {
    @Id
    @GeneratedValue(strategy = GenerationType.IDENTITY)
    private Long id;
    
    @Column(nullable = false)
    private String name;
    
    @Column(nullable = false, unique = true)
    private String email;
    
    @Enumerated(EnumType.STRING)
    @Column(nullable = false)
    private String role;
    
    @Builder        // ìƒì„±ìì— @Builder ì• ë„ˆí…Œì´ì…˜ ì ìš© ì˜ˆì‹œ / í´ë˜ìŠ¤ ë ˆë²¨ì´ ì•„ë‹ˆë¼.
    public User(String name, String email, Role role) {
        this.name = name;
        this.email = email;
        this.role = role;
    }
    
    public User update(String name) {
        this.name = name;
        return this;
    }
}
```
domain íŒ¨í‚¤ì§€ì— Enum - Role.java íŒŒì¼ ìƒì„±
Enum
- ì—´ê±°í˜•(Enumeration)ì„ ì˜ë¯¸.
  _ì„œë¡œ ê´€ë ¨ëœ ìƒìˆ˜ë¥¼ ëª¨ì•„ë†“ì€ ì§‘í•©ì²´_

ìƒìˆ˜ë§Œ ëª¨ì•„ë†¨ê¸° ë•Œë¬¸ì— ë‚˜ì¤‘ì— ìœ ì§€ ë³´ìˆ˜ê°€ í¸í•©ë‹ˆë‹¤. (.env í•  ë•Œ ìƒìˆ˜ë¡œ ê´€ë¦¬í•˜ë©´ í¸í–ˆë˜ ê²ƒê³¼ ê°™ìŠµë‹ˆë‹¤)

- ì¸ìŠ¤í„´ìŠ¤ ìƒì„±ê³¼ ìƒì†ì„ í—ˆìš©í•˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ì ì—ì„œ ì•ˆì •ì„± ìˆìŒ.